<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: scripts/login.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: scripts/login.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/* === login.js | Handles user authentication, login guard and login logic === */

let exampleContacts = [
   {"username": "Peter", "email": "peter-lustig@hotmail.de", "PhoneNumber": "+491517866563", "color": "pink"},
   {"username": "Karsten", "email": "karsten-stahl@gmail.de", "PhoneNumber": "+49151478632475", "color": "orange"},
   {"username": "Thomas", "email": "thomas-gottschalck@live.de", "PhoneNumber": "+491517896455", "color": "green"},
   {"username": "Rainer", "email": "rainer-winkler@gmail.de", "PhoneNumber": "+491507489652", "color": "blue"},
   {"username": "Angela", "email": "angela-merkel@gmail.de", "PhoneNumber": "+491511462385", "color": "red"},
   {"username": "Kai", "email": "kai-pflaume@live.de", "PhoneNumber": "+491504896257", "color": "yellow"},
   {"username": "Til", "email": "til-schweiger@gmail.de", "PhoneNumber": "+491514563248", "color": "orange"},
   {"username": "Günther", "email": "günther-jauch@gmail.de", "PhoneNumber": "+4915157652244", "color": "blue"},
   {"username": "Simon", "email": "simon-krätschmer@gmail.de", "PhoneNumber": "+491504621354", "color": "red"}
];

/* === Firebase Configuration === */
const BASE_URL = "https://join-a3ae3-default-rtdb.europe-west1.firebasedatabase.app/";
users = [];


/* === Fetch Users from Firebase === */
/**
 * Fetches all user records from Firebase at the specified path.
 * @param {string} path - The database path to query.
 * @returns {Promise&lt;Object>} The JSON response containing all users.
 */
async function getAllUsers(path){
  let response = await fetch(BASE_URL + path + ".json");
  return responseToJson = await response.json();
}


/* === Initialize Users Array === */
/**
 * Fills the global users array with all users from Firebase,
 * mapping each entry to an object containing its ID and data.
 * @returns {Promise&lt;void>}
 */
async function fillArray(){
   let userResponse = await getAllUsers("users");
   let UserKeysArray = Object.keys(userResponse);
   for (let index = 0; index &lt; UserKeysArray.length; index++) {
      users.push(
         {
               id : UserKeysArray[index], 
               user : userResponse[UserKeysArray[index]],
         }
      ) 
   }
   console.log(users);
}


/* === Login Handling === */
/**
 * Processes a login attempt: validates email format, checks credentials,
 * displays error messages, and redirects on success.
 * @param {Event} event - The form submit event.
 */
function login(event){
   if (event) event.preventDefault(); 
    const email = document.getElementById('email').value.trim();
    const password = document.getElementById('password').value.trim();
    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    if (!emailRegex.test(email)) {
      const errorEl = document.getElementById("error_message");
      errorEl.textContent = "Bitte eine gültige E-Mail eingeben!";
      errorEl.classList.remove("visually-hidden");
      errorEl.style.color = "red";
      return;
    }
    const loginSuccessful = checkUsernamePassword(email, password);
    checkUsernamePassword(email, password);
   if(loginSuccessful){
      console.log("Login erfolgreich! Weiterleitung...");
      window.location.href = "./summaryAll.html";  
   } else {
      console.log("Login fehlgeschlagen.");
      const errorEl = document.getElementById("error_message");
      errorEl.textContent = "E-Mail oder Passwort ist ungültig!";
      errorEl.classList.remove("visually-hidden");
      errorEl.style.color = "red";  
   }
}


/**
 * Logs the user in as a guest, stores guest data locally,
 * and redirects to the summary page.
 */
function loginAsGuest() {
   const guest = {
      id: "guest",
      name: "Guest",
      email: "guest@guest.com",
      friends: (typeof exampleContacts !== "undefined" ? exampleContacts : [])
   };
   localStorage.setItem("userData", JSON.stringify(guest));
   window.location.href = "./summaryAll.html";
}


/* === Credential Verification === */
/**
 * Validates the user's email and password against the Firebase-loaded users array.
 * @param {string} inputMail - The email entered by the user.
 * @param {string} inputPassword - The password entered by the user.
 * @returns {boolean} True if credentials match, otherwise false.
 */
function checkUsernamePassword(inputMail, inputPassword){
   for (let index = 0; index &lt; users.length; index++) {
      let actualName = users[index].user.name;
      let actualMail = users[index].user.email;
      let actualPassword = users[index].user.password;
      let actualID = users[index].id;
      let actualFriendlist = users[index].user.friends || [];
      let actualJson = {"id" : actualID, "name" : actualName, "email" : actualMail, "friends" : actualFriendlist}
   if(actualMail === inputMail &amp;&amp; actualPassword === inputPassword){   
            putUserDataIntoLocalStorage(actualJson);
            return true;
      }
   }
   return false;
}


/* === Local Storage Handling === */
/**
 * Stores logged-in user data in localStorage.
 * @param {Object} inputJson - The user data object to store.
 */
function putUserDataIntoLocalStorage(inputJson){
   localStorage.setItem("userData", JSON.stringify(inputJson));
}


/* === Login Guard === */
/**
 * Guards protected pages by checking login state.
 * Redirects to the login page if no user is found in localStorage.
 */
function checkIfLogedIn() {
   const user = localStorage.getItem("userData");
   if (!user) {
      window.location.href = "./index.html";
      return;
   }
   document.body.style.visibility = "visible";
}

/* === Form Validation === */
/**
 * Enables or disables the login button based on email and password input fields.
 */
function checkLogin() {
   const email = document.getElementById('email').value.trim();
   const password = document.getElementById('password').value.trim();
   const button = document.getElementById('login_button');
   button.disabled = !(email &amp;&amp; password);
 }


 document.getElementById("email").addEventListener("blur", () => {
   const email = document.getElementById("email").value.trim();
   const emailValid = /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
   const errorEl = document.getElementById("error_message");
 
   if (email &amp;&amp; !emailValid) {
     errorEl.textContent = "Bitte eine gültige E-Mail eingeben!";
     errorEl.classList.remove("visually-hidden");
   } else {
     errorEl.textContent = "";
     errorEl.classList.add("visually-hidden");
   }
 });


 document.getElementById("password").addEventListener("blur", () => {
   const email = document.getElementById("email").value.trim();
   const password = document.getElementById("password").value.trim();
   const errorEl = document.getElementById("error_message");
 
   if (email &amp;&amp; password &amp;&amp; !checkUsernamePassword(email, password)) {
     errorEl.textContent = "E-Mail oder Passwort ist ungültig!";
     errorEl.classList.remove("visually-hidden");
   } else if (email &amp;&amp; password &amp;&amp; checkUsernamePassword(email, password)) {
     errorEl.textContent = "";
     errorEl.classList.add("visually-hidden");
   }
 });

</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#BASE_URL">BASE_URL</a></li><li><a href="global.html#activeHighlightColumnId">activeHighlightColumnId</a></li><li><a href="global.html#addActiveClassToSidebarButtons">addActiveClassToSidebarButtons</a></li><li><a href="global.html#addContactToLocalStorageAndAPI">addContactToLocalStorageAndAPI</a></li><li><a href="global.html#addNewContact">addNewContact</a></li><li><a href="global.html#afterRender">afterRender</a></li><li><a href="global.html#applyStatusChangeForDraggedTask">applyStatusChangeForDraggedTask</a></li><li><a href="global.html#assignedToDataExtractSafe">assignedToDataExtractSafe</a></li><li><a href="global.html#autoMoveTimeoutId">autoMoveTimeoutId</a></li><li><a href="global.html#bigCardDynamicHtml">bigCardDynamicHtml</a></li><li><a href="global.html#bigCardDynamicTechnicalHtml">bigCardDynamicTechnicalHtml</a></li><li><a href="global.html#bigCardHtml">bigCardHtml</a></li><li><a href="global.html#buildSubtaskListItem">buildSubtaskListItem</a></li><li><a href="global.html#callWhiteScreen">callWhiteScreen</a></li><li><a href="global.html#cancelScheduledAutoMove">cancelScheduledAutoMove</a></li><li><a href="global.html#checkIfBlockIsFilled">checkIfBlockIsFilled</a></li><li><a href="global.html#checkIfLogedIn">checkIfLogedIn</a></li><li><a href="global.html#checkLogin">checkLogin</a></li><li><a href="global.html#checkPolicyandAnswers">checkPolicyandAnswers</a></li><li><a href="global.html#checkUsernamePassword">checkUsernamePassword</a></li><li><a href="global.html#clearAllColumnHighlights">clearAllColumnHighlights</a></li><li><a href="global.html#clearForm">clearForm</a></li><li><a href="global.html#closeAddTask">closeAddTask</a></li><li><a href="global.html#closeModal">closeModal</a></li><li><a href="global.html#closeTaskModal">closeTaskModal</a></li><li><a href="global.html#closeWhiteScreen">closeWhiteScreen</a></li><li><a href="global.html#collectTaskFromForm">collectTaskFromForm</a></li><li><a href="global.html#contactBlock">contactBlock</a></li><li><a href="global.html#createTask">createTask</a></li><li><a href="global.html#createUser">createUser</a></li><li><a href="global.html#currentDragCardEl">currentDragCardEl</a></li><li><a href="global.html#currentlySelectedContact">currentlySelectedContact</a></li><li><a href="global.html#deleteContact">deleteContact</a></li><li><a href="global.html#deleteContactinEditContactWindow">deleteContactinEditContactWindow</a></li><li><a href="global.html#deleteDynamicTask">deleteDynamicTask</a></li><li><a href="global.html#deleteIdFromLocalStorage">deleteIdFromLocalStorage</a></li><li><a href="global.html#deleteTask">deleteTask</a></li><li><a href="global.html#demoContactTemplate">demoContactTemplate</a></li><li><a href="global.html#demoTasks">demoTasks</a></li><li><a href="global.html#editContact">editContact</a></li><li><a href="global.html#emptyTheAddContactFormular">emptyTheAddContactFormular</a></li><li><a href="global.html#enableSubtaskEditing">enableSubtaskEditing</a></li><li><a href="global.html#fallbackModal">fallbackModal</a></li><li><a href="global.html#fillArray">fillArray</a></li><li><a href="global.html#filterAssignList">filterAssignList</a></li><li><a href="global.html#finalizeAssignSearch">finalizeAssignSearch</a></li><li><a href="global.html#findColumnByPointer">findColumnByPointer</a></li><li><a href="global.html#findIndexFromUsername">findIndexFromUsername</a></li><li><a href="global.html#generateTaskId">generateTaskId</a></li><li><a href="global.html#getAddTaskTemplate">getAddTaskTemplate</a></li><li><a href="global.html#getAllTasks">getAllTasks</a></li><li><a href="global.html#getAllUsers">getAllUsers</a></li><li><a href="global.html#getAssignSearchValue">getAssignSearchValue</a></li><li><a href="global.html#getBadgeClass">getBadgeClass</a></li><li><a href="global.html#getBigCardDynamicHtml">getBigCardDynamicHtml</a></li><li><a href="global.html#getBigCardDynamicTechnicalHtml">getBigCardDynamicTechnicalHtml</a></li><li><a href="global.html#getColorFromItem">getColorFromItem</a></li><li><a href="global.html#getContactColorType">getContactColorType</a></li><li><a href="global.html#getDraggedTask">getDraggedTask</a></li><li><a href="global.html#getInitials">getInitials</a></li><li><a href="global.html#getInitialsFromName">getInitialsFromName</a></li><li><a href="global.html#getNextDeadline">getNextDeadline</a></li><li><a href="global.html#getRandomInt">getRandomInt</a></li><li><a href="global.html#getSubtasksSafe">getSubtasksSafe</a></li><li><a href="global.html#getTaskCounts">getTaskCounts</a></li><li><a href="global.html#getTechnicalTaskTemplate">getTechnicalTaskTemplate</a></li><li><a href="global.html#getUserID">getUserID</a></li><li><a href="global.html#getWhiteScreen">getWhiteScreen</a></li><li><a href="global.html#greetUserName">greetUserName</a></li><li><a href="global.html#handleAssignInput">handleAssignInput</a></li><li><a href="global.html#handleContactClick">handleContactClick</a></li><li><a href="global.html#hideAddContactFormular">hideAddContactFormular</a></li><li><a href="global.html#hideEditContactFormular">hideEditContactFormular</a></li><li><a href="global.html#hydrateAssignSection">hydrateAssignSection</a></li><li><a href="global.html#initAddTaskTemplateHandlers">initAddTaskTemplateHandlers</a></li><li><a href="global.html#isAssignPlaceholderEvent">isAssignPlaceholderEvent</a></li><li><a href="global.html#isDemoTask">isDemoTask</a></li><li><a href="global.html#isRealDate">isRealDate</a></li><li><a href="global.html#isTechnicalType">isTechnicalType</a></li><li><a href="global.html#isUserStoryType">isUserStoryType</a></li><li><a href="global.html#isValidDateFormat">isValidDateFormat</a></li><li><a href="global.html#jumpToLogin">jumpToLogin</a></li><li><a href="global.html#lastDragPointerX">lastDragPointerX</a></li><li><a href="global.html#loadTasks">loadTasks</a></li><li><a href="global.html#loadTasksFromFirebase">loadTasksFromFirebase</a></li><li><a href="global.html#login">login</a></li><li><a href="global.html#loginAsGuest">loginAsGuest</a></li><li><a href="global.html#makeFirstLetterBig">makeFirstLetterBig</a></li><li><a href="global.html#mapCategoryToType">mapCategoryToType</a></li><li><a href="global.html#matchesSearch">matchesSearch</a></li><li><a href="global.html#nameOfTheCard">nameOfTheCard</a></li><li><a href="global.html#needsDraggingClassAfterRender">needsDraggingClassAfterRender</a></li><li><a href="global.html#normaliseSubtaskProgress">normaliseSubtaskProgress</a></li><li><a href="global.html#normalizeTaskType">normalizeTaskType</a></li><li><a href="global.html#onclickFunction">onclickFunction</a></li><li><a href="global.html#onloadFunctionHeader">onloadFunctionHeader</a></li><li><a href="global.html#openAddTask">openAddTask</a></li><li><a href="global.html#openModalDynamic">openModalDynamic</a></li><li><a href="global.html#patchDataWithID">patchDataWithID</a></li><li><a href="global.html#pendingAutoMoveStatus">pendingAutoMoveStatus</a></li><li><a href="global.html#pendingDragTiltClass">pendingDragTiltClass</a></li><li><a href="global.html#persistTasks">persistTasks</a></li><li><a href="global.html#pollSummary">pollSummary</a></li><li><a href="global.html#populateEditOverlay">populateEditOverlay</a></li><li><a href="global.html#postDataWithID">postDataWithID</a></li><li><a href="global.html#prevOnload">prevOnload</a></li><li><a href="global.html#priorit%25C3%25A4tIcon">prioritätIcon</a></li><li><a href="global.html#processAssignSearch">processAssignSearch</a></li><li><a href="global.html#pushExampleContactsOneTimeInLocalStorage">pushExampleContactsOneTimeInLocalStorage</a></li><li><a href="global.html#putUserDataIntoLocalStorage">putUserDataIntoLocalStorage</a></li><li><a href="global.html#putUsernameInContactList">putUsernameInContactList</a></li><li><a href="global.html#readSubtasksFromForm">readSubtasksFromForm</a></li><li><a href="global.html#removeContentfromAllContactBlocks">removeContentfromAllContactBlocks</a></li><li><a href="global.html#render">render</a></li><li><a href="global.html#renderAddContact">renderAddContact</a></li><li><a href="global.html#renderAssignedAvatars">renderAssignedAvatars</a></li><li><a href="global.html#renderContactList">renderContactList</a></li><li><a href="global.html#renderContactsInDropdown">renderContactsInDropdown</a></li><li><a href="global.html#renderEditContact">renderEditContact</a></li><li><a href="global.html#renderSingleContact">renderSingleContact</a></li><li><a href="global.html#renderUserMenuePopupMenu">renderUserMenuePopupMenu</a></li><li><a href="global.html#resetAssignSearch">resetAssignSearch</a></li><li><a href="global.html#sanitizeDueDateInput">sanitizeDueDateInput</a></li><li><a href="global.html#saveEditedSubtask">saveEditedSubtask</a></li><li><a href="global.html#saveTask">saveTask</a></li><li><a href="global.html#saveTaskEdits">saveTaskEdits</a></li><li><a href="global.html#scheduleAutoMoveTo">scheduleAutoMoveTo</a></li><li><a href="global.html#searchQuery">searchQuery</a></li><li><a href="global.html#selectAssignUser">selectAssignUser</a></li><li><a href="global.html#setActiveSidebarByURL">setActiveSidebarByURL</a></li><li><a href="global.html#setContactsIntoContactblock">setContactsIntoContactblock</a></li><li><a href="global.html#setLetterInUserBall">setLetterInUserBall</a></li><li><a href="global.html#setPriorityAddTask">setPriorityAddTask</a></li><li><a href="global.html#setSummaryText">setSummaryText</a></li><li><a href="global.html#setUserDataValue">setUserDataValue</a></li><li><a href="global.html#shouldResetAssignSearch">shouldResetAssignSearch</a></li><li><a href="global.html#showAddContactFormular">showAddContactFormular</a></li><li><a href="global.html#showContactToast">showContactToast</a></li><li><a href="global.html#showEditContactFormular">showEditContactFormular</a></li><li><a href="global.html#showToast">showToast</a></li><li><a href="global.html#singleContactTemplate">singleContactTemplate</a></li><li><a href="global.html#sortUserToAlphabeticalOrder">sortUserToAlphabeticalOrder</a></li><li><a href="global.html#startEditTask">startEditTask</a></li><li><a href="global.html#statusByColumnId">statusByColumnId</a></li><li><a href="global.html#subscribeToFirebaseUpdates">subscribeToFirebaseUpdates</a></li><li><a href="global.html#toggleAssignDropdown">toggleAssignDropdown</a></li><li><a href="global.html#toggleContactHighlight">toggleContactHighlight</a></li><li><a href="global.html#toggleUserMenuePopupMenu">toggleUserMenuePopupMenu</a></li><li><a href="global.html#updateAssignPlaceholder">updateAssignPlaceholder</a></li><li><a href="global.html#updateFriendsInLocalStorage">updateFriendsInLocalStorage</a></li><li><a href="global.html#updateSearchClearButtonState">updateSearchClearButtonState</a></li><li><a href="global.html#updateSummary">updateSummary</a></li><li><a href="global.html#updateTimeout">updateTimeout</a></li><li><a href="global.html#updateUserFriendslist">updateUserFriendslist</a></li><li><a href="global.html#userMenuTemplate">userMenuTemplate</a></li><li><a href="global.html#validateDueDate">validateDueDate</a></li><li><a href="global.html#whichCardActuellDrop">whichCardActuellDrop</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.5</a> on Fri Nov 21 2025 13:33:32 GMT+0100 (Central European Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
